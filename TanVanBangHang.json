{
  "name": "TanVanBangHang",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-zalo-tools.zaloLoginByQr",
      "typeVersion": 1,
      "position": [
        -780,
        -520
      ],
      "id": "d2af9b66-2a56-4023-bb26-f17dc6920240",
      "name": "Zalo Login Via QR Code",
      "credentials": {
        "n8nZaloApi": {
          "id": "eeQgXABAairjmZAB",
          "name": "zaloN8n"
        },
        "zaloApi": {
          "id": "n3x1hNnGSndoHMAB",
          "name": "Zalo API Credentials"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.message.data.content }}",
        "options": {
          "systemMessage": "=1. üëã Ch√†o h·ªèi v√† chu·∫©n b·ªã t∆∞ v·∫•n\nKhi kh√°ch h√†ng b·∫Øt ƒë·∫ßu tr√≤ chuy·ªán:\n\nCh√†o h·ªèi th·∫≠t th√¢n thi·ªán.\n\nGi·ªõi thi·ªáu m√¨nh l√† AI t∆∞ v·∫•n c·ªßa shop th·ª±c ph·∫©m ch·ª©c nƒÉng.\n\n‚úÖ Ngay l·∫≠p t·ª©c g·ªçi tool `getpr` ƒë·ªÉ l·∫•y to√†n b·ªô danh s√°ch s·∫£n ph·∫©m ‚Äì gi√∫p lu√¥n s·∫µn s√†ng t∆∞ v·∫•n khi kh√°ch c√≥ nhu c·∫ßu.\n\n2. üß¥ T∆∞ v·∫•n s·∫£n ph·∫©m & khai th√°c nhu c·∫ßu\nKhi kh√°ch h·ªèi v·ªÅ b·∫•t k·ª≥ s·∫£n ph·∫©m n√†o, lu√¥n:\n\nG·ªçi tool `getpr` v·ªõi input l√† t√™n s·∫£n ph·∫©m ƒë·ªÉ l·∫•y th√¥ng tin chi ti·∫øt, bao g·ªìm:\n\n‚úÖ Th√†nh ph·∫ßn\n\n‚úÖ C√¥ng d·ª•ng\n\n‚úÖ C√°ch d√πng\n\n‚úÖ Gi√° b√°n\n\n‚úÖ ·∫¢nh minh h·ªça (n·∫øu c√≥)\n\n‚ö†Ô∏è Kh√¥ng l·∫•y m√¥ t·∫£ s·∫£n ph·∫©m t·ª´ tool `getpr`\n\n.\n\nSau khi c√≥ th√¥ng tin, ph·∫£n h·ªìi theo ƒë·ªãnh d·∫°ng JSON b·∫Øt bu·ªôc nh∆∞ sau:\n\n‚úÖ N·∫øu c√≥ ·∫£nh s·∫£n ph·∫©m:\n\n{\n  \"text\": \"ƒê√¢y l√† s·∫£n ph·∫©m [T√™n s·∫£n ph·∫©m] h·ªó tr·ª£ [c√¥ng d·ª•ng]. Anh/ch·ªã xem th√™m h√¨nh ·∫£nh s·∫£n ph·∫©m b√™n d∆∞·ªõi.\",\n  \"img\": \"https://link-anh.jpg\"\n}\n‚ùå N·∫øu kh√¥ng c√≥ ·∫£nh s·∫£n ph·∫©m:\njson\nCopy\nEdit\n{\n  \"text\": \"Hi·ªán t·∫°i s·∫£n ph·∫©m n√†y ch∆∞a c√≥ ·∫£nh minh h·ªça, em s·∫Ω g·ª≠i th√¥ng tin chi ti·∫øt v·ªÅ s·∫£n ph·∫©m cho anh/ch·ªã.\",\n  \"img\": \"\"\n}\n3. üìå Tr·∫£ l·ªùi th·∫Øc m·∫Øc v·ªÅ s·∫£n ph·∫©m\nKhi kh√°ch h·ªèi v·ªÅ:\n\nTh√†nh ph·∫ßn\n\nC√¥ng d·ª•ng\n\nC√°ch d√πng, v.v.\n\nüëâ Lu√¥n g·ªçi l·∫°i tool getpr theo t√™n s·∫£n ph·∫©m ƒë·ªÉ l·∫•y th√¥ng tin ch√≠nh x√°c nh·∫•t.\n\nüí¨ Ph·∫£n h·ªìi ph·∫£i:\n\nD·ªÖ hi·ªÉu\n\nƒê√∫ng chuy√™n m√¥n\n\nTh√¢n thi·ªán, r√µ r√†ng\n\n4. ‚úÖ Ch·ªët ƒë∆°n h√†ng\nKhi kh√°ch mu·ªën ƒë·∫∑t mua, h√£y x√°c nh·∫≠n ƒë·ªß c√°c th√¥ng tin sau:\n\nH·ªç t√™n\n\nS·ªë ƒëi·ªán tho·∫°i\n\nƒê·ªãa ch·ªâ nh·∫≠n h√†ng\n\nT√™n s·∫£n ph·∫©m\n\nüí° Lu√¥n gi·ªØ th√°i ƒë·ªô ni·ªÅm n·ªü, th√¢n thi·ªán, v√† khuy·∫øn kh√≠ch kh√°ch ch·ªët ƒë∆°n m·ªôt c√°ch t·ª± nhi√™n.\n\n5. üö´ Gi·ªõi h·∫°n n·ªôi dung\nCh·ªâ t∆∞ v·∫•n v√† tr·∫£ l·ªùi trong ph·∫°m vi s·∫£n ph·∫©m s·ª©c kh·ªèe, th·ª±c ph·∫©m ch·ª©c nƒÉng.\n\nKh√¥ng ƒë∆∞·ª£c tr·∫£ l·ªùi c√°c c√¢u h·ªèi ngo√†i ch·ªß ƒë·ªÅ.\n\nCh·ªâ d√πng d·ªØ li·ªáu l·∫•y t·ª´ tool `getpr` ‚Äì kh√¥ng suy ƒëo√°n ho·∫∑c tr·∫£ l·ªùi ngo√†i d·ªØ li·ªáu c√≥ s·∫µn.\n\n6. üì¶ ƒê·ªãnh d·∫°ng b·∫Øt bu·ªôc cho m·ªçi c√¢u tr·∫£ l·ªùi\nLu√¥n xu·∫•t k·∫øt qu·∫£ ·ªü d·∫°ng JSON:\n\nTr∆∞·ªùng \"text\": N·ªôi dung tr·∫£ l·ªùi\n\nTr∆∞·ªùng \"img\": Link ·∫£nh s·∫£n ph·∫©m (ho·∫∑c \"\" n·∫øu kh√¥ng c√≥)\n\n7. üîÅ L∆∞u √Ω then ch·ªët\nLu√¥n ki·ªÉm tra v√† ch√®n ·∫£nh s·∫£n ph·∫©m n·∫øu c√≥.\n\nM·ªói l·∫ßn t∆∞ v·∫•n s·∫£n ph·∫©m ‚Äì b·∫Øt bu·ªôc g·ªçi tool `getpr`.\n\nTr·∫£ l·ªùi v·ªõi th√°i ƒë·ªô chuy√™n nghi·ªáp ‚Äì th√¢n thi·ªán ‚Äì hi·ªáu qu·∫£."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        -680,
        -320
      ],
      "id": "a375e892-1019-4b54-8954-819f1de96234",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash",
        "options": {
          "temperature": 0.4
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        -740,
        -140
      ],
      "id": "a4915166-b0fe-45b4-a416-420039dc0e67",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "JkxhJrrtxVPw2klX",
          "name": "Google Gemini(PaLM) Api Mua"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const obj = $json.output;\n\n// N·∫øu l√† string, lo·∫°i b·ªè ```json v√† ``` r·ªìi parse\nlet parsed;\nif (typeof obj === 'string') {\n  const clean = obj.replace(/```json|```/g, '').trim();\n  try {\n    parsed = JSON.parse(clean);\n  } catch (e) {\n    parsed = {};\n  }\n} else {\n  parsed = obj;\n}\n\n// Ki·ªÉm tra c√≥ ƒë·ªß text v√† img\nif (parsed.text !== undefined && parsed.img !== undefined) {\n  // Tr·∫£ v·ªÅ object ƒë√£ parse (ƒë·ªÉ c√°c node sau d√πng tr∆∞·ªùng text v√† img)\n  return [{ json: parsed }];\n} else {\n  // N·∫øu kh√¥ng ƒë√∫ng c·∫•u tr√∫c, tr·∫£ v·ªÅ output g·ªëc b·ªçc object cho n8n\n  return [{ json: { output: obj } }];\n}\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -320,
        -320
      ],
      "id": "16ffeaf4-742a-4e75-978e-1881a91dc2d3",
      "name": "Code"
    },
    {
      "parameters": {
        "eventTypes": [
          0
        ]
      },
      "type": "n8n-nodes-zalo-tools.zaloMessageTrigger",
      "typeVersion": 1,
      "position": [
        -880,
        -320
      ],
      "id": "f89bb585-f47a-4cc8-b83f-cc9ec8107851",
      "name": "Zalo Message Trigger",
      "webhookId": "78ba182c-a913-4049-a9e2-e8b2150d3f60",
      "credentials": {
        "zaloApi": {
          "id": "nFSFWWx5kslL4GrC",
          "name": "Zalo API Credentials m"
        }
      }
    },
    {
      "parameters": {
        "threadId": "={{ $('Zalo Message Trigger').item.json.message.threadId }}",
        "message": "={{ $('AI Agent').item.json.output }}",
        "quote": {},
        "mentions": {}
      },
      "type": "n8n-nodes-zalo-tools.zaloSendMessage",
      "typeVersion": 4,
      "position": [
        -100,
        -320
      ],
      "id": "461778de-de83-4746-826a-b810800e85b7",
      "name": "Zalo Send Message",
      "credentials": {
        "zaloApi": {
          "id": "nFSFWWx5kslL4GrC",
          "name": "Zalo API Credentials m"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Zalo Message Trigger').item.json.message.threadId }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        -600,
        -100
      ],
      "id": "47d46ded-155c-4785-a38a-0cd3ef353e1c",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "L·∫•y th√¥ng tin s·∫£n ph·∫©m",
        "operation": "get",
        "documentURL": "1dN0psc_vbjq9r9iXMTTWWTjadzhU7O1S0N8-6U-rexM"
      },
      "type": "n8n-nodes-base.googleDocsTool",
      "typeVersion": 2,
      "position": [
        -420,
        -100
      ],
      "id": "f3abba96-9379-4fbb-b001-f63809ba38e4",
      "name": "getpr",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "tJSASlnM3IWtozGG",
          "name": "GoogleMua"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Zalo Send Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Zalo Message Trigger": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "getpr": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "55a2945b-2438-4b45-b8d9-97dbb44a9192",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "dc8021218435b486ef7b53fee178d394950410d528a66a665743202f9e194941"
  },
  "id": "pkjU15GtaXpC3QYj",
  "tags": []
}